//ISA armv7-a cortex-a8 cortex-a9
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include "insn_code.h"
struct dep i_code;
struct dep i_code_t;
//FILE *fptr;
//FILE *fptr2;
FILE *result;
char buff[50];
unsigned long long cycle_cnt = 0, cycle_last = 0;
uint32_t insn_op1;
//char* filename = "/home/yhchiang/tracerlog/insn_trace_A.log";
#define QEMU_TEST
void table_17(uint32_t insn){
}
void table_18(uint32_t insn){
	uint8_t op2 =(insn>5)&0x3;
	uint8_t imm5 = (insn>>7)&0x1F;
	if(op2==0){
		if(imm5 ==0){
			printf("MOV reg ARM\n");
			i_code.vartype = 3;
			regimmVal(insn, i_code);
			cycle_cnt +=1;
		}
		else {
			printf("LSL imm \n");
			i_code.vartype = 3;
			regimmVal(insn, i_code);
			cycle_cnt +=1;
		}
	}
	else if(op2==1){
		printf("LSR imm\n");
			cycle_cnt +=1;
		i_code.vartype = 3;
		regimmVal(insn, i_code);
	}
	else if(op2==2){
		printf("ASR imm\n");
			cycle_cnt +=1;
		i_code.vartype = 3;
		regimmVal(insn, i_code);
	}
	else if(op2==3){
		if(imm5 == 0){
			printf("RRX \n");
			cycle_cnt +=1;
			i_code.vartype = 3;
			regimmVal(insn, i_code);
		}
		else {
			printf("ROR imm\n");
			cycle_cnt +=1;
			i_code.vartype = 3;
			regimmVal(insn, i_code);
		}
	}
	else printf("error\n");
}
void table_3(uint32_t insn){//Data-processing (register)
	uint8_t op = (insn>>20)&0x1F;
	uint8_t op_1 = op>>1;
	if(op_1 == 0){
		printf("AND reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 1){
		printf("EOR reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 2){
		printf("SUB reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 3){
		printf("RSB reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 4){
		printf("ADD reg ARM\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 5){
		printf("ADC reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 6){
		printf("SBC reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 7){
		printf("RSC reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if((op&0x19)==0x10)table_00(insn);//Data-processing and miscellaneous instructions
	else if(op == 0x11){
		printf("TST reg\n");
			cycle_cnt +=1;
		i_code.vartype = 2;
		regimmVal(insn, i_code);
	}
	else if(op == 0x13){
		printf("TEQ reg\n");
			cycle_cnt +=1;
		i_code.vartype = 2;
		regimmVal(insn, i_code);
	}
	else if(op == 0x15){
		printf("CMP reg\n");
			cycle_cnt +=1;
		i_code.vartype = 2;
		regimmVal(insn, i_code);
	}
	else if(op == 0x17){
		printf("CMN reg\n");
			cycle_cnt +=1;
		i_code.vartype = 2;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 0xC){
		printf("ORR reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 0xD)table_18(insn);
	else if(op_1 == 0xE){
		printf("BIC reg\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op_1 == 0xF){
		printf("MVN reg\n");
			cycle_cnt +=1;
		i_code.vartype = 3;
		regimmVal(insn, i_code);
	}
	else printf("error\n");

}
void table_19(uint32_t insn){
	uint8_t op2 = (insn>>5)&0x3;
	if(op2==0){
		printf("LSL reg\n");
			cycle_cnt +=1;
		i_code.vartype = 6;
		regimmVal(insn, i_code);
	}
	else if(op2==1){
		printf("LSR reg\n");
			cycle_cnt +=1;
		i_code.vartype = 6;
		regimmVal(insn, i_code);
	}
	else if(op2==2){
		printf("ASR reg\n");
			cycle_cnt +=1;
		i_code.vartype = 6;
		regimmVal(insn, i_code);
	}
	else if(op2==3){
		printf("ROR reg\n");
			cycle_cnt +=1;
		i_code.vartype = 6;
		regimmVal(insn, i_code);
	}
	else printf("error\n");
}
void table_4(uint32_t insn){//Data-processing (register-shifted register)
	uint8_t op1 = (insn>>20)&0x1F;

	uint8_t op1_1 = op1>>1;
	if(op1_1 == 0){
		printf("AND reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 1){
		printf("EOR reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 2){
		printf("SUB reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 3){
		printf("RSBreg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 4){
		printf("ADD reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 5){
		printf("ADC reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 6){
		printf("SBC reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 7){
		printf("RSC reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if((op1&0x19)==0x10)table_00(insn);//Data-processing and miscellaneous instructions
	else if(op1 == 0x11){
		printf("TST reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 5;
		regimmVal(insn, i_code);
	}
	else if(op1 == 0x13){
		printf("TEQ reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 5;
		regimmVal(insn, i_code);
	}
	else if(op1 == 0x15){
		printf("CMP reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 5;
		regimmVal(insn, i_code);
	}
	else if(op1 == 0x17){
		printf("CMN reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 5;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 0xC){
		printf("ORR reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 0xD)table_19(insn);
	else if(op1_1 == 0xE){
		printf("BIC reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 4;
		regimmVal(insn, i_code);
	}
	else if(op1_1 == 0xF){
		printf("MVN reg-shift reg\n");
			cycle_cnt +=1;
		i_code.vartype = 7;
		regimmVal(insn, i_code);
	}
	else printf("error\n");

}
void table_20(uint32_t insn){//Saturating addition and subtraction
	uint8_t op = (insn>>21)&0x3;
	if(op==0){
		printf("QADD\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op==1){
		printf("QSUB\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op==2){
		printf("QDADD\n");
			cycle_cnt +=1;
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else if(op==3){
		printf("QDSUB\n");
		i_code.vartype = 1;
		regimmVal(insn, i_code);
	}
	else printf("error\n");
}
void table_5(uint32_t insn){//Miscellaneous instructions on page
	uint8_t op2 = (insn>>4)&0x7;
	uint8_t B = (insn>>9)&0x1; // //B?
	uint8_t op = (insn>>21)&0x3;
	uint8_t op1 = (insn>>16)&0xf;
	if(op2==0){
		if(B==1){
			if(op&1==0){
				printf("MRS banked reg\n");
			cycle_cnt +=1;
				i_code.vartype = 8;
				regimmVal(insn, i_code);
			}
			else if(op&1==1){
				printf("MSR banked reg\n");
			cycle_cnt +=1;
				i_code.vartype = 9;
				regimmVal(insn, i_code);
			}
		}
		else if(B==0){
			if(op&1==0){
				printf("MRS MRS\n");
			cycle_cnt +=1;
				i_code.vartype = 8;
				regimmVal(insn, i_code);
			}
			else if(op==0x1){
				if((op1&0x3)==0){
					printf("MSR reg\n");
			cycle_cnt +=1;
					i_code.vartype = 9;
					regimmVal(insn, i_code);
				}
				else if((op1&0x3)==1 || (op1&0x2)==0x2){
					printf("MSR reg\n");
			cycle_cnt +=1;
					i_code.vartype = 9;
					regimmVal(insn, i_code);
				}
			}
			else if(op==0x3){
				printf("MSR reg\n");
			cycle_cnt +=1;
				i_code.vartype = 9;
				regimmVal(insn, i_code);
			}
		}
	}
	else if(op2==0x1){
		if(op==0x1){
			printf("BX\n");
			cycle_cnt +=1;
			i_code.vartype = 10;
			regimmVal(insn, i_code);
		}
		else if(op==0x3){
			printf("CLZ\n");
			cycle_cnt +=1;
			i_code.vartype = 3;
			regimmVal(insn, i_code);
		}
	}
	else if(op2==0x2 && op==0x1){
		printf("BXJ\n");
			cycle_cnt +=1;
		i_code.vartype = 10;
		regimmVal(insn, i_code);
	}
	else if(op2==0x3 && op==0x1){
		printf("BLX reg\n");
			cycle_cnt +=1;
		i_code.vartype = 10;
		regimmVal(insn, i_code);
	}
	else if(op2==0x5)table_20(insn);//Saturating addition and subtraction
	else if(op2==0x6 && op==0x3){
		printf("ERET\n");
			cycle_cnt +=1;
		i_code.affect==0;
	}
	else if(op2==0x7){
		if(op==1){
			printf("BKPT\n");
			cycle_cnt +=1;
			i_code.affect==0;
		}
		else if(op==2){
			printf("HVC\n");
			cycle_cnt +=1;
			i_code.affect==0;
		}
		else if(op==3){
			printf("SMC (pre SMI)\n");
			cycle_cnt +=1;
			i_code.affect==0;
		}
	}
}
void table_6(uint32_t insn){//Halfword multiply and multiply accumulate
	uint8_t op1 = (insn>>21)&0x3;
	uint8_t op = (insn>>5)&0x1;
	if(op1==0){
		printf("SMLABB BT TB TT\n");
			cycle_cnt +=1;
		i_code.vartype = 11;
		regimmVal(insn, i_code);
	}
	else if(op1==1 && op==0){
		printf("SMLAWB SMLAWT\n");
			cycle_cnt +=1;
		i_code.vartype = 11;
		regimmVal(insn, i_code);
	}
	else if(op1==1 && op==1){
		printf("SMULWB SMULWT\n");
			cycle_cnt +=1;
		i_code.vartype = 12;
		regimmVal(insn, i_code);
	}
	else if(op1==2){
		printf("SMLALBB SMLALBT SMLALTB SMLALT\n");
			cycle_cnt +=1;
		i_code.vartype = 13;
		regimmVal(insn, i_code);
	}
	else if(op1==3){
		printf("SMULBB SMULBT SMULTB SMULTT\n");
			cycle_cnt +=1;
		i_code.vartype = 12;
		regimmVal(insn, i_code);
	}
	else printf("error\n");
}
void table_7(uint32_t insn){//Multiply and multiply accumulate
	uint8_t op = (insn>>20)&0xF;
	if(op>>1==0){
		printf("MUL\n");
			cycle_cnt +=1;
		i_code.vartype = 14;
		regimmVal(insn, i_code);
	}
	else if(op>>1==1){
		printf("MLA\n");
			cycle_cnt +=1;
		i_code.vartype = 11;
		regimmVal(insn, i_code);
	}
	else if(op==0x4){
		printf("UMAAL\n");
			cycle_cnt +=1;
		i_code.vartype = 13;
		regimmVal(insn, i_code);
	}
	else if(op==0x5){
		printf("undefined\n");
	}
	else if(op==0x6){
		printf("MLS\n");
			cycle_cnt +=1;
		i_code.vartype = 11;
		regimmVal(insn, i_code);
	}
	else if(op==0x7){
		printf("undefined\n");
	}
	else if(op>>1==0x4){
		printf("UMULL\n");
			cycle_cnt +=1;
		i_code.vartype = 13;
		regimmVal(insn, i_code);
	}
	else if(op>>1==0x5){
		printf("UMLAL\n");
			cycle_cnt +=1;
		i_code.vartype = 13;
		regimmVal(insn, i_code);
	}
	else if(op>>1==0x6){
		printf("SMULL\n");
			cycle_cnt +=1;
		i_code.vartype = 13;
		regimmVal(insn, i_code);
	}
	else if(op>>1==0x7){
		printf("SMLAL\n");
			cycle_cnt +=1;
		i_code.vartype = 13;
		regimmVal(insn, i_code);
	}
	else printf("error");
}
void table_8(uint32_t insn){//Synchronization primitives
	uint8_t op = (insn>>20)&0xF;
	if((op&0xB)==0){
		printf("SWP SWPB\n");
			cycle_cnt +=1;
		i_code.vartype = 15;
		regimmVal(insn, i_code);
	}
	else if(op==0x8){
		printf("STREX\n");
			cycle_cnt +=1;
		i_code.vartype = 16;
		regimmVal(insn, i_code);
	}
	else if(op==0x9){
		printf("LDREX\n");
			cycle_cnt +=1;
		i_code.vartype = 17;
		regimmVal(insn, i_code);
	}
	else if(op==0xA){
		printf("STREXD\n");
			cycle_cnt +=1;
		i_code.vartype = 16;
		regimmVal(insn, i_code);
	}
	else if(op==0xB){
		printf("LDREXD\n");
			cycle_cnt +=1;
		i_code.vartype = 17;
		regimmVal(insn, i_code);
	}
	else if(op==0xC){
		printf("STREXB\n");
			cycle_cnt +=1;
		i_code.vartype = 16;
		regimmVal(insn, i_code);
	}
	else if(op==0xD){
		printf("LDREXB\n");
			cycle_cnt +=1;
		i_code.vartype = 17;
		regimmVal(insn, i_code);
	}
	else if(op==0xE){
		printf("STREXH\n");
			cycle_cnt +=1;
		i_code.vartype = 16;
		regimmVal(insn, i_code);
	}
	else if(op==0xF){
		printf("LDREXH\n");
			cycle_cnt +=1;
		i_code.vartype = 17;
		regimmVal(insn, i_code);
	}
	else printf("error\n");
}
void table_9(uint32_t insn){//Extra load/store instructions
//op1!= 0xx1x  op2=1 [01] 1
	uint8_t op1 = ((insn>>20)&0x1F)&0x5;
	uint8_t Rn = (insn>>16)&0xf;
	if(op1==0){
		printf("STRH reg\n");
			cycle_cnt +=1;
		i_code.vartype = 18;
		regimmVal(insn, i_code);
	}
	else if(op1==1){
		printf("LDRH reg\n");
			cycle_cnt +=1;
		i_code.vartype = 18;
		regimmVal(insn, i_code);
	}
	else if(op1==4){
		printf("STRH imm ARM\n");
			cycle_cnt +=1;
		i_code.vartype = 17;
		regimmVal(insn, i_code);
	}
	else if(op1==5){
		if(Rn==0xf){
			printf("LDRH imm ARM\n");
			cycle_cnt +=1;
			i_code.vartype = 17;
			regimmVal(insn, i_code);
		}
		else {
			printf("LDRH literal\n");
			cycle_cnt +=1;
			i_code.vartype = 19;
			regimmVal(insn, i_code);
		}
	}
	else printf("error\n");
}
void table_10(uint32_t insn){//Extra load/store instructions
//op2=1 [1x] 1
	uint8_t op1 = ((insn>>20)&0x1F)&0x5;
	uint8_t Rn = (insn>>16)&0xf;
	uint8_t op2 = (insn>>5)&0x3;
	if(op2==2){
		if(op1==0){
			printf("LDRD reg\n");
			cycle_cnt +=1;
			i_code.vartype = 18;
			regimmVal(insn, i_code);
		}
		else if(op1==1){
			printf("LDRSB reg\n");
			cycle_cnt +=1;
			i_code.vartype = 18;
			regimmVal(insn, i_code);
		}
		else if(op1==4){
			if(Rn==0xf){
				printf("LDRD imm\n");
			cycle_cnt +=1;
				i_code.vartype = 17;
				regimmVal(insn, i_code);
			}
			else {
				printf("LDRD literal\n");
			cycle_cnt +=1;
				i_code.vartype = 19;
				regimmVal(insn, i_code);
			}
		}
		else if(op1==5){
			if(Rn==0xf){
				printf("LDRSB imm\n");
			cycle_cnt +=1;
				i_code.vartype = 17;
				regimmVal(insn, i_code);
			}
			else {
				printf("LDRSB literal\n");
			cycle_cnt +=1;
				i_code.vartype = 19;
				regimmVal(insn, i_code);
			}
		}
	}
	else if(op2==0x3){
		if(op1==0){
			printf("STRD reg\n");
			cycle_cnt +=1;
			i_code.vartype = 18;
			regimmVal(insn, i_code);
		}
		else if(op1==1){
			printf("LDRSH reg\n");
			cycle_cnt +=1;
			i_code.vartype = 18;
			regimmVal(insn, i_code);
		}
		else if(op1==4){
			printf("STRD imm\n");
			cycle_cnt +=1;
			i_code.vartype = 17;
			regimmVal(insn, i_code);
		}
		else if(op1==5){
			if(Rn==0xF){
				printf("LDRSH imm\n");
			cycle_cnt +=1;
				i_code.vartype = 17;
				regimmVal(insn, i_code);
			}
			else {
				printf("LDRSH literal\n");
			cycle_cnt +=1;
				i_code.vartype = 19;
				regimmVal(insn, i_code);
			}
		}
	}
	else printf("error\n");
}
void table_11(uint32_t insn){//Extra load/store instructions, unprivileged
	uint8_t op2 = (insn>>5)&0x3;
	uint8_t op = (insn>>20)&0x1;
	if(op2==1 && op==0){
		printf("STRHT\n");
			cycle_cnt +=1;
		i_code.vartype = 18;
		regimmVal(insn, i_code);
	}
	else if(op2==1 && op==1){
		printf("LDRHT\n");
			cycle_cnt +=1;
		i_code.vartype = 18;
		regimmVal(insn, i_code);
	}
	else if(op2==2 && op==1){
		printf("LDRSBT\n");
			cycle_cnt +=1;
		i_code.vartype = 18;
		regimmVal(insn, i_code);
	}
	else if(op2==3 && op==1){
		printf("LDRSHT\n");
			cycle_cnt +=1;
		i_code.vartype = 18;
		regimmVal(insn, i_code);
	}
	else printf("error\n");

}
void table_12(uint32_t insn){//Extra load/store instructions
	uint8_t op1 = (insn>>20)&0x1F;
	uint8_t Rn = (insn>>16)&0xf;
	uint8_t op2 = (insn>>5)&0x3;
	if(op2==0x0 || (op1&0x13)==3 ||((op1&0x13)==0x2 && (op2&0x2)==0))table_00(insn);
	else printf("error\n");
}
void table_13(uint32_t insn){//Data-processing (immediate)
	uint8_t op = (insn>>20)&0x1f;
	uint8_t Rn = (insn>>16)&0xf;
	uint8_t op_1 = op>>1;
	if(op_1==0){
		printf("AND imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==1){
		printf("EOR imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==2){
		if(Rn!=0xF){
			printf("SUB imm ARM\n");
			cycle_cnt +=1;
			i_code.vartype = 20;
			regimmVal(insn, i_code);
		}
		else {
			printf("ADR\n");
			cycle_cnt +=1;
			i_code.vartype = 8;
			regimmVal(insn, i_code);
		}
	}
	else if(op_1==3){
		printf("RSB imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==4){
		if(Rn!=0xF){
			printf("ADD imm ARM\n");
			cycle_cnt +=1;
			i_code.vartype = 20;
			regimmVal(insn, i_code);
		}
		else {
			printf("ADR\n");
			cycle_cnt +=1;
			i_code.vartype = 8;
			regimmVal(insn, i_code);
		}
	}
	else if(op_1==5){
		printf("ADC imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==6){
		printf("SBC imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==7){
		printf("RSC imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if((op&0x19)==0x10)table_00(insn);
	else if(op==0x11){
		printf("TST imm\n");
			cycle_cnt +=1;
		i_code.vartype = 21;
		regimmVal(insn, i_code);
	}
	else if(op==0x13){
		printf("TEQ imm\n");
			cycle_cnt +=1;
		i_code.vartype = 21;
		regimmVal(insn, i_code);
	}
	else if(op==0x15){
		printf("CMP imm\n");
			cycle_cnt +=1;
		i_code.vartype = 21;
		regimmVal(insn, i_code);
	}
	else if(op==0x17){
		printf("CMN imm\n");
			cycle_cnt +=1;
		i_code.vartype = 21;
		regimmVal(insn, i_code);
	}
	else if(op_1==0xC){
		printf("ORR imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==0xD){
		printf("MOV imm\n");
			cycle_cnt +=1;
		i_code.vartype = 8;
		regimmVal(insn, i_code);
	}
	else if(op_1==0xE){
		printf("BIC imm\n");
			cycle_cnt +=1;
		i_code.vartype = 20;
		regimmVal(insn, i_code);
	}
	else if(op_1==0xF){
		printf("MVN imm\n");
			cycle_cnt +=1;
		i_code.vartype = 8;
		regimmVal(insn, i_code);
	}
	else printf("error\n");

}
void table_14(uint32_t insn){//16-bit immediate load
	printf("MOV imm\n");
			cycle_cnt +=1;
	i_code.vartype = 8;
	regimmVal(insn, i_code);
}
void table_15(uint32_t insn){//High halfword 16-bit immediate load
	printf("MOVT \n");
			cycle_cnt +=1;
	i_code.vartype = 8;
	regimmVal(insn, i_code);
}
void table_16(uint32_t insn){//MSR (immediate), and hints
	uint8_t op = (insn>>22)&0x1;
	uint8_t op1 = (insn>>16)&0xf;
	uint8_t op2 = insn & 0xFF;
	if(op==0){
		if(op1==0){
			if(op2==0x00){
				printf("NOP\n");
			cycle_cnt +=1;
			}
			else if(op2==0x01){
				printf("YIELD\n");
			cycle_cnt +=1;
			}
			else if(op2==0x02){
				printf("WFE\n");
			cycle_cnt +=1;
			}
			else if(op2==0x3){
				printf("WFI\n");
			cycle_cnt +=1;
			}
			else if(op2==0x4){
				printf("SEV\n");
			cycle_cnt +=1;
			}
			else if((op2>>4)==0xf){
				printf("DBG\n");
			cycle_cnt +=1;
			}
		}
		else if(op1==0x4 || (op1&0xB)==0x8){
			printf("MSR(A) imm\n");
			cycle_cnt +=1;
		}
		else if((op1&0x3)==0x1 || (op1&0x2)==0x2){
			printf("MSR(B) imm\n");
			cycle_cnt +=1;
		}
	}
	else if(op==1){
		printf("MSR(B) imm\n");
			cycle_cnt +=1;
	}
	else printf("error\n");
	i_code.affect==0;
}
void table_1(uint32_t insn){
	uint8_t op1 = (insn>>20)&0x1F;
	uint8_t op2 = (insn>>4)&0xF;
	if((op1&0x19)!=0x10){
		if((op2&0x1)==0)table_3(insn);//Data-processing (register)
		else if((op2&0x9)==1)table_4(insn);//Data-processing (register-shifted register)
	}
	else if((op1&0x19)==0x10){
		if((op2&0x8)==0)table_5(insn);//Miscellaneous instructions on page
		else if((op2&0x9)==0x8)table_6(insn);//Halfword multiply and multiply accumulate
	}
	else if((op1&0x10)==0 && op2==0x9)table_7(insn);//Multiply and multiply accumulate
	else if((op1&0x10)==1 && op2==0x9)table_8(insn);//Synchronization primitives
	else if((op1&0x12)!=2){
		if(op2==0xB)table_9(insn);//Extra load/store instructions
		else if((op2&0xD)==0xD)table_10(insn);//Extra load/store instructions
	}
	else if((op1&0x12)==2){
		if(op2==0xB)table_11(insn);//Extra load/store instructions, unprivileged
		else if((op2&0xD)==0xD)table_12(insn);//Extra load/store instructions
	}
	else printf("error\n");
}
void table_2(uint32_t insn){
	uint8_t op1 = (insn>>20)&0x1F;
	if((op1&0x19)!=0x10)table_13(insn); //Data-processing (immediate)
	else if(op1==0x10)table_14(insn); //16-bit immediate load, MOV (immediate)
	else if(op1==0x14)table_15(insn); //High halfword 16-bit immediate load, MOVT
	else if((op1&0x1B)==0x12)table_16(insn); //MSR (immediate), and hints
}
void table_00(uint32_t insn){//Data-processing and miscellaneous instructions
	uint8_t op = (insn>>25)&1;

	if(op==0)table_1(insn);
	else if(op==1)table_2(insn);
	else printf("error\n");
}
void table_01(uint32_t insn){//Load/store word and unsigned byte
//op1[25:27] = 010
//A=0
	uint8_t op1 = (insn>>20)&0x1F;
	uint8_t Rn = (insn>>16)&0xF;
	uint8_t op1_1 = op1&0x5;
	uint8_t op1_2 = op1&0x17;
	if(op1_1==0 && op1_2!=2){
        printf("STR imm ARM\n");
			cycle_cnt +=1;
        i_code.vartype = 17;
        regimmVal(insn, i_code);
	}
	else if(op1_2==2){
        printf("STRT \n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_1==1 && op1_2!=3 && Rn!=0xF){
        printf("LDR imm ARM\n");
			cycle_cnt +=1;
        i_code.vartype = 17;
        regimmVal(insn, i_code);
	}
	else if(op1_1==1 && op1_2!=3 && Rn==0xF){
        printf("LDR literal\n");
			cycle_cnt +=1;
        i_code.vartype = 19;
        regimmVal(insn, i_code);
	}
	else if(op1_2==3){
        printf("LDRT\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_1==4 && op1_2!=6){
        printf("STRB imm ARM\n");
			cycle_cnt +=1;
        i_code.vartype = 17;
        regimmVal(insn, i_code);
	}
	else if(op1_2==6){
        printf("STRBT\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_1==5 && op1_2!=7 && Rn!=0xF){
        printf("LDRB imm ARM\n");
			cycle_cnt +=1;
        i_code.vartype = 17;
        regimmVal(insn, i_code);
	}
	else if(op1_1==5 && op1_2!=7 && Rn==0xF){
        printf("LDRB literal\n");
			cycle_cnt +=1;
        i_code.vartype = 19;
        regimmVal(insn, i_code);
	}
	else if(op1_2==7){
        printf("LDRBT\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
}
void table_02(uint32_t insn){//Load/store word and unsigned byte
//op1[25:27] = 011
//A=1
    if((insn>>25)&1==1 && (insn>>4)&1==1){
        table_03(insn);
        return;
    }
    uint8_t op1 = (insn>>20)&0x1F;
    uint8_t op1_1 = op1&0x5;
	uint8_t op1_2 = op1&0x17;
    if(op1_1==0 && op1_2!=2){
        printf("STR reg\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_2==2){
        printf("STRT \n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_1==1 && op1_2!=3){
        printf("LDR reg ARM\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_2==3){
        printf("LDRT\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_1==4 && op1_2!=6){
        printf("STRB reg\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_2==6){
        printf("STRBT\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_1==5 && op1_2!=7){
        printf("LDRB reg\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
	else if(op1_2==7){
        printf("LDRBT\n");
			cycle_cnt +=1;
        i_code.vartype = 18;
        regimmVal(insn, i_code);
	}
}
void table_25(uint32_t insn){//Saturating instructions
    uint8_t op2 = (insn>>5)&0x7;
    if(op2==0){
        printf("QADD16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==1){
        printf("QASX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==2){
        printf("QSAX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==3){
        printf("QSUB16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==4){
        printf("QADD8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==7){
        printf("QSUB8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else printf("error\n");
}
void table_26(uint32_t insn){//Halving instructions
    uint8_t op2 = (insn>>5)&0x7;
    if(op2==0){
        printf("SHADD16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==1){
        printf("SHASX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==2){
        printf("SHSAX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==3){
        printf("SHSUB16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==4){
        printf("SHADD8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==7){
        printf("SHSUB8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else printf("error\n");
}
void table_21(uint32_t insn){//Parallel addition and subtraction, signed
    uint8_t op1 = (insn>>20)&0x3;
    uint8_t op2 = (insn>>5)&0x7;
    if(op1==2)table_25(insn);//Saturating instructions
    else if(op1==3)table_26(insn);//Halving instructions
    else if(op1==1){
        if(op2==0){
            printf("SADD16\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==1){
            printf("SASX\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==2){
            printf("SSAX\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==3){
            printf("SSUB16\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==4){
            printf("SADD8\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==7){
            printf("SSUB8\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
    }
    else printf("error\n");
}
void table_27(uint32_t insn){//Saturating instructions
    uint8_t op2 = (insn>>5)&0x7;
    if(op2==0){
        printf("UQADD16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==1){
        printf("UQASX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==2){
        printf("UQSAX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==3){
        printf("UQSUB16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==4){
        printf("UQADD8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==7){
        printf("UQSUB8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else printf("error\n");
}
void table_28(uint32_t insn){//Halving instructions
    uint8_t op2 = (insn>>5)&0x7;
    if(op2==0){
        printf("UHADD16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==1){
        printf("UHASX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==2){
        printf("UHSAX\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==3){
        printf("UHSUB16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==4){
        printf("UHADD8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op2==7){
        printf("UHSUB8\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else printf("error\n");
}
void table_22(uint32_t insn){//Parallel addition and subtraction, unsigned
    uint8_t op1 = (insn>>20)&0x3;
    uint8_t op2 = (insn>>5)&0x7;
    if(op1==2)table_25(insn);//Saturating instructions
    else if(op1==3)table_26(insn);//Halving instructions
    else if(op1==1){
        if(op2==0){
            printf("UADD16\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==1){
            printf("UASX\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==2){
            printf("USAX\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==3){
            printf("USUB16\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==4){
            printf("UADD8\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
        else if(op2==7){
            printf("USUB8\n");
			cycle_cnt +=1;
            i_code.vartype = 1;
            regimmVal(insn, i_code);
        }
    }
    else printf("error\n");
}
void table_23(uint32_t insn){//Packing, unpacking, saturation, and reversal
    uint8_t op1 = (insn>>20)&0x7;
    uint8_t op2 = (insn>>5)&0x7;
    uint8_t A = (insn>>16)&0xF;
    if(op1==0 && op2&1==0){
        printf("PKH\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==0 && op2==3 && A!=0xF){
        printf("SXTAB16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==0 && op2==3 && A==0xF){
        printf("SXTB16\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==0 && op2==5 ){
        printf("SEL\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1>>1==1 && op2&1==0){
        printf("SSAT\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1==2 && op2==1){
        printf("SSAT16\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1==2 && op2==3 && A!=0xF){
        printf("SXTAB\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==2 && op2==3 && A==0xF){
        printf("SXTB\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==3 && op2==1){
        printf("REV\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==3 && op2==3 && A!=0xF){
        printf("SXTAH\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==3 && op2==3 && A==0xF){
        printf("SXTH\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==3 && op2==5){
        printf("REV16\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==4 && op2==3 && A!=0xF){
        printf("UXTAB16\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==4 && op2==3 && A==0xF){
        printf("UXTB16\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1>>1==3 && op2&1==0){
        printf("USAT\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1==6 && op2==1){
        printf("USAT16\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1==6 && op2==3 && A!=0xF){
        printf("UXTAB\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==6 && op2==3 && A==0xF){
        printf("UXTB\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==7 && op2==1){
        printf("RBIT\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==7 && op2==3 && A!=0xF){
        printf("UXTAH\n");
			cycle_cnt +=1;
        i_code.vartype = 1;
        regimmVal(insn, i_code);
    }
    else if(op1==7 && op2==3 && A==0xF){
        printf("UXTH\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else if(op1==7 && op2==5){
        printf("REVSH\n");
			cycle_cnt +=1;
        i_code.vartype = 3;
        regimmVal(insn, i_code);
    }
    else printf("error\n");

}
void table_24(uint32_t insn){//Signed multiply, signed and unsigned divide
    uint8_t op1 = (insn>>20)&0x7;
    uint8_t op2 = (insn>>5)&0x7;
    uint8_t A = (insn>>16)&0xF;
    if(op1==0){
        if(op2>>1==0 && A!=0xF){
            printf("SMLAD\n");
			cycle_cnt +=1;
            i_code.vartype = 11;
            regimmVal(insn, i_code);
        }
        else if(op2>>1==0 && A==0xF){
            printf("SMUAD\n");
			cycle_cnt +=1;
            i_code.vartype = 12;
            regimmVal(insn, i_code);
        }
        else if(op2>>1==1 && A!=0xF){
            printf("SMLSD\n");
			cycle_cnt +=1;
            i_code.vartype = 11;
            regimmVal(insn, i_code);
        }
        else if(op2>>1==1 && A==0xF){
            printf("SMUSD\n");
			cycle_cnt +=1;
            i_code.vartype = 12;
            regimmVal(insn, i_code);
        }
    }
    else if(op1==1 && op2==0){
        printf("SDIV\n");
			cycle_cnt +=1;
        i_code.vartype = 12;
        regimmVal(insn, i_code);
    }
    else if(op1==3 && op2==0){
        printf("UDIV\n");
			cycle_cnt +=1;
        i_code.vartype = 12;
        regimmVal(insn, i_code);
    }
    else if(op1==4 && op2>>1==0){
        printf("SMLALD\n");
			cycle_cnt +=1;
        i_code.vartype = 13;
        regimmVal(insn, i_code);
    }
    else if(op1==4 && op2>>1==1){
        printf("SMLSLD\n");
			cycle_cnt +=1;
        i_code.vartype = 13;
        regimmVal(insn, i_code);
    }
    else if(op1==5 && op2>>1==0 && A!=0xF){
        printf("SMMLA\n");
			cycle_cnt +=1;
        i_code.vartype = 11;
        regimmVal(insn, i_code);
    }
    else if(op1==5 && op2>>1==0 && A==0xF){
        printf("SMMUL\n");
			cycle_cnt +=1;
        i_code.vartype = 12;
        regimmVal(insn, i_code);
    }
    else if(op1==5 && op2>>1==3){
        printf("SMMLS\n");
			cycle_cnt +=1;
        i_code.vartype = 11;
        regimmVal(insn, i_code);
    }
    else printf("error\n");

}
void table_03(uint32_t insn){//Media instructions
    uint8_t op1 = (insn>>20)&0x1F;
    uint8_t op2 = (insn>>5)&0x7;
    uint8_t Rn = insn&0xF;
    uint8_t Rd = (insn>>12)&0xF;
    uint8_t cond = (insn>>28)&0xF;
    if(op1>>2==0)table_21(insn);//Parallel addition and subtraction, signed
    else if(op1>>2==1)table_22(insn);//Parallel addition and subtraction, unsigned
    else if(op1>>3==1)table_23(insn);//Packing, unpacking, saturation, and reversal
    else if(op1>>3==2)table_24(insn);//Signed multiply, signed and unsigned divide on
    else if(op1==0x18 && op2==0 && Rd==0xF){
        printf("USAD8\n");
			cycle_cnt +=1;
        i_code.vartype = 14;
        regimmVal(insn, i_code);
    }
    else if(op1==0x18 && op2==0 && Rd!=0xF){
        printf("USADA8\n");
			cycle_cnt +=1;
        i_code.vartype = 11;
        regimmVal(insn, i_code);
    }
    else if(op1>>1==0xD && op2&0x3==2){
        printf("SBFX\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1>>1==0xE && op2&0x3==0 && Rn==0xF){
        printf("BFC\n");
			cycle_cnt +=1;
        i_code.vartype = 8;
        regimmVal(insn, i_code);
    }
    else if(op1>>1==0xE && op2&0x3==0 && Rn!=0xF){
        printf("BFI\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1>>1==0xF && op2&0x3==2){
        printf("UBFX\n");
			cycle_cnt +=1;
        i_code.vartype = 22;
        regimmVal(insn, i_code);
    }
    else if(op1==0x1F && op2==0x7 && cond==0xE){
        printf("UDF\n");
			cycle_cnt +=1;
        i_code.affect==0;
    }
    else if(op1==0x1F && op2==0x7 && cond!=0xE){
        printf("unconditional\n");
    }
    else printf("error\n");
}
void table_04(uint32_t insn){//Branch, branch with link, and block data transfer
    uint8_t op = (insn>>20)&0x3F;
    uint8_t op_1 = op&0x3D;
    uint8_t Rn = (insn>>16)&0xF;
    uint8_t R = (insn>>15)&1;
    uint16_t Rlist;
    if(op_1==0){
        printf("STMDA(STMED)\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op_1==1){
        printf("LDMDA/LDMFA\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op_1==8){
        printf("STM(STMIA,STMEA)\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op==9){
        printf("LDM/LDMIA/LDMFD (ARM)\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op==0xB && Rn!=0xD){
        printf("LDM/LDMIA/LDMFD (ARM)\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op==0xB && Rn==0xD){
        printf("POP (ARM)\n");
			cycle_cnt +=1;
        Rlist = insn & 0xffff;
	while(Rlist>0){
		   if(Rlist&1==1)cycle_cnt+=1;
		   Rlist=Rlist>>1;
	}
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(op==0x10){
        printf("STMDB (STMFD) \n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op==0x12 && Rn!=0xD){
        printf("STMDB (STMFD) \n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op==0x12 && Rn==0xD){
        printf("PUSH\n");
			cycle_cnt +=1;
        Rlist = insn & 0xffff;
	while(Rlist>0){
		   if(Rlist&1==1)cycle_cnt+=1;
		   Rlist=Rlist>>1;
	}
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(op_1==0x11){
        printf("LDMDB/LDMEA\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op_1==0x18){
        printf("STMIB (STMFA)\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op_1==0x19){
        printf("LDMIB/LDMED\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op&0x25==4){
        printf("STM (User registers)\n");
			cycle_cnt +=1;
        i_code.vartype = 23;
        regimmVal(insn, i_code);
    }
    else if(op&0x25==5 && R==0){
        printf("LDM (User registers) \n");
			cycle_cnt +=1;
        i_code.vartype = 24;
        regimmVal(insn, i_code);
    }
    else if(op&0x25==5 && R==1){
        printf("LDM (exception return) \n");
			cycle_cnt +=1;
        i_code.vartype = 24;
        regimmVal(insn, i_code);
    }
    else if(op>>4==2){
        printf("B label\n");
			cycle_cnt +=1;
        i_code.affect==0;
    }
    else if(op>>4==3){
        printf("BL, BLX imm\n");
			cycle_cnt +=1;
        i_code.affect==0;
    }
    else printf("error\n");
}
void table_29(uint32_t insn){//Extension register load/store instructions
    uint8_t opcode = (insn>>20)&0x1F;
    uint8_t Rn = (insn>>16)&0xF;
    uint8_t op = opcode&0x1B;
    if(opcode>>1==2)table_30(insn);
    else if(op==0x8){
        printf("VSTM\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op==0xA){
        printf("VSTM\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(opcode&0x13==0x10){
        printf("VSTR\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op==0x12 && Rn!=0xF){
        printf("VSTM\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op==0x12 && Rn==0xF){
        printf("VPUSH\n");
        i_code.affect==0;
    }
    else if(op==0x9){
        printf("VLDM\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op==0xB && Rn!=0xF){
        printf("VLDM\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op==0xB && Rn==0xF){
        printf("VPOP\n");
        i_code.affect==0;
    }
    else if(opcode&0x13==0x11){
        printf("VLDR\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op==0x13){
        printf("VLDM\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else printf("error\n");


}
void table_30(uint32_t insn){//64-bit transfers between ARM core and extension registers
    uint8_t C = (insn>>8)&1;
    uint8_t op = (insn>>4)&0xF;
    if(C==0 && op&0xD==1){
        printf("VMOV (between two ARM core registers and two single-precision registers)\n");
        i_code.vartype = 25;
        regimmVal(insn, i_code);
    }
    else if(C==1 && op&0xD==1){
        printf("VMOV (between two ARM core registers and a doubleword extension register) \n");
        i_code.vartype = 25;
        regimmVal(insn, i_code);
    }
    else printf("error\n");
}
void table_42(uint32_t insn){//Vreg
    uint8_t opc2 = (insn>>16)&0xF;
    uint8_t opc3 = (insn>>6)&0x3;
    uint8_t op3 = opc3&0x1;
    if(op3==0){
        printf("VMOV (immediate) \n");
    }
    else if(opc2==0 &&opc3==1){
        printf("VMOV (reg) \n");
    }
    else if(opc2==0 &&opc3==3){
        printf("VABS\n");
    }
    else if(opc2==1 &&opc3==1){
        printf("VNEG\n");
    }
    else if(opc2==1 &&opc3==3){
        printf("VSQRT\n");
    }
    else if(opc2>>1==1 &&op3==1){
        printf("VCVTB, VCVTT\n");
    }
    else if(opc2>>1==2 &&op3==1){
        printf("VCMP, VCMPE\n");
    }
    else if(opc2==7 &&opc3==3){
        printf("VCVT (between double-precision and single-precision)\n");
    }
    else if(opc2==8 &&op3==1){
        printf("VCVT, VCVTR (between floating-point and integer, Floating-point)\n");
    }
    else if(opc2>>1==5 &&op3==1){
        printf("VCVT (between floating-point and fixed-point, Floating-point)\n");
    }
    else if(opc2>>1==6 &&op3==1){
        printf("VCVT, VCVTR (between floating-point and integer, Floating-point)\n");
    }
    else if(opc2>>1==7 &&op3==1){
        printf("VCVT (between floating-point and fixed-point, Floating-point)\n");
    }
    else printf("error\n");
    i_code.affect==0;

}
void table_31(uint32_t insn){//Floating-point data-processing instructions  Vreg
    uint8_t opc1 = (insn>>20)&0xF;
    uint8_t opc3 = (insn>>6)&0x3;
    uint8_t op = opc1&0xB;
    uint8_t op3 = opc3&0x1;
    if(op==0xB)table_42(insn);
    else if(op==0){
        printf("VMLA, VMLS (floating-point)\n");
    }
    else if(op==1){
        printf("VNMLA, VNMLS, VNMUL\n");
    }
    else if(op==2 && op3==1){
        printf("VNMLA, VNMLS, VNMUL\n");
    }
    else if(op==2 && op3==0){
        printf("VMUL (floating-point)\n");
    }
    else if(op==3 && op3==0){
        printf("VADD (floating-point)\n");
    }
    else if(op==3 && op3==1){
        printf("VSUB (floating-point) \n");
    }
    else if(op==8 && op3==0){
        printf("VDIV\n");
    }
    else if(op==9){
        printf("VFNMA, VFNMS\n");
    }
    else if(op==0xA){
        printf("VFMA, VFMS\n");
    }
    else printf("error\n");
    i_code.affect==0;
}
void table_32(uint32_t insn){//8, 16, and 32-bit transfer between ARM core and extension registers
    uint8_t L = (insn>>20)&0x1;
    uint8_t C = (insn>>8)&0x1;
    uint8_t A = (insn>>21)&0x7;
    uint8_t B = (insn>>5)&0x3; // //B?
    if(L==0 && C==0 && A==0){
        printf("VMOV (between ARM core register and single-precision register)\n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(L==0 && C==0 && A==0x7){
        printf("VMSR VMSR(System level view)\n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(L==0 && C==1 && A>>2==0){
        printf("VMOV (ARM core register to scalar) \n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(L==0 && C==1 && A>>2==1 && B>1==0){
        printf("VDUP (ARM core register) \n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(L==1 && C==0 && A==0){
        printf("VMOV (between ARM core register and single-precision register) \n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(L==1 && C==0 && A==0x7){
        printf("VMSR VMSR(System level view)\n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else if(L==1 && C==1){
        printf("VMOV (scalar to ARM core register)\n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
    }
    else printf("error\n");


}
void table_05(uint32_t insn){//Coprocessor instructions, and Supervisor Call
    uint8_t coproc = (insn>>8)&0xF;
    uint8_t op1 = (insn>>20)&0x3F;
    uint8_t op = (insn>>4)&1;
    uint8_t Rn = (insn>>16)&0xF;
    if(op1>>1 == 0)printf("undefined\n");
    else if(op1>>4==3){
        printf("SVC (previously SWI) \n");
			cycle_cnt +=1;
        i_code.affect==0;
    }
    else if(coproc>>1!=5){
        if(op1&0x21==0 && op1&0x3B!=0){
            printf("STC, STC2\n");
			cycle_cnt +=1;
            i_code.vartype = 21;
            regimmVal(insn, i_code);
        }
        else if(op1&0x21==1 && op1&0x3B!=1 && Rn!=0xF){
            printf("LDC, LDC2 (immediate) \n");
			cycle_cnt +=1;
            i_code.vartype = 21;
            regimmVal(insn, i_code);
        }
        else if(op1&0x21==1 && op1&0x3B!=1 && Rn==0xF){
            printf("LDC, LDC2 (literal) \n");
			cycle_cnt +=1;
            i_code.affect==0;
        }
        else if(op1==0x4){
            printf("MCRR, MCRR2\n");
			cycle_cnt +=1;
            i_code.vartype = 25;
            regimmVal(insn, i_code);
        }
        else if(op1==0x5){
            printf("MRRC, MRRC2\n");
			cycle_cnt +=1;
            i_code.vartype = 25;
            regimmVal(insn, i_code);
        }
        else if(op1>>4==2 && op==0){
            printf("CDP, CDP2\n");
			cycle_cnt +=1;
            i_code.affect==0;
        }
        else if(op1&0x31==0x20 && op==1){
            printf("MCR, MCR2\n");
			cycle_cnt +=1;
            i_code.vartype = 19;
            regimmVal(insn, i_code);
        }
        else if(op1&0x31==0x21 && op==1){
            printf("MRC, MRC2 \n");
			cycle_cnt +=1;
            i_code.vartype = 19;
            regimmVal(insn, i_code);
        }
    }
    else if(coproc>>1==5){
        if(op1>>5==0 && op1&0x3A!=0)table_29(insn);//Extension register load/store instructions
        else if(op1>>1==2)table_30(insn);//64-bit transfers between ARM core and extension registers
        else if(op1>>4==2 && op==0)table_31(insn);//Floating-point data-processing instructions
        else if(op1>>4==2 && op==1)table_32(insn);//8, 16, and 32-bit transfer between ARM core and extension registers
    }
    else printf("error\n");
}
void table_36(uint32_t insn){//Three registers of the same length
    uint8_t U = (insn>>24)&1;
    uint8_t C = (insn>>20)&0x3;
    uint8_t A = (insn>>8)&0xF;
    uint8_t B1 = (insn>>4)&0x1;
    if(A==0 && B1==0){
        printf("VHADD, VHSUB \n");
    }
    else if(A==0 && B1==1){
        printf("VQADD\n");
    }
    else if(A==1 && B1==0){
        printf("VRHADD\n");
    }
    else if(A==1 && B1==1 && U==0 && C==0){
        printf("VAND (register) \n");
    }
    else if(A==1 && B1==1 && U==0 && C==1){
        printf("VBIC (register) \n");
    }
    else if(A==1 && B1==1 && U==0 && C==2){
        printf("VORR (register)  if source registers differ\n");
    }
    else if(A==1 && B1==1 && U==0 && C==2){
        printf("VMOV (register) if source registers identical\n");
    }
    else if(A==1 && B1==1 && U==0 && C==3){
        printf("VORN (register)\n");
    }
    else if(A==1 && B1==1 && U==1 && C==0){
        printf("VEOR \n");
    }
    else if(A==1 && B1==1 && U==1 && C==1){
        printf("VBIF, VBIT, VBSL\n");
    }
    else if(A==1 && B1==1 && U==1 && C==2){
        printf("VBIF, VBIT, VBSL\n");
    }
    else if(A==1 && B1==1 && U==1 && C==3){
        printf("VBIF, VBIT, VBSL\n");
    }
    else if(A==2 && B1==0){
        printf("VHADD, VHSUB\n");
    }
    else if(A==2 && B1==1){
        printf("VQSUB\n");
    }
    else if(A==3 && B1==0){
        printf("VCGT (register)\n");
    }
    else if(A==3 && B1==1){
        printf("VCGE (register) \n");
    }
    else if(A==4 && B1==0){
        printf("VSHL (register)\n");
    }
    else if(A==4 && B1==1){
        printf("VQSHL (register)\n");
    }
    else if(A==5 && B1==0){
        printf("VRSHL\n");
    }
    else if(A==5 && B1==1){
        printf("VQRSHL\n");
    }
    else if(A==6){
        printf("VMAX, VMIN (integer) \n");
    }
    else if(A==7 && B1==0){
        printf("VABD, VABDL (integer)\n");
    }
    else if(A==7 && B1==1){
        printf("VABA, VABAL\n");
    }
    else if(A==8 && B1==0 && U==0){
        printf("VADD (integer)\n");
    }
    else if(A==8 && B1==0 && U==1){
        printf("VSUB (integer)\n");
    }
    else if(A==8 && B1==1 && U==0){
        printf("VTST\n");
    }
    else if(A==8 && B1==1 && U==1){
        printf("VCEQ (register)\n");
    }
    else if(A==9 && B1==0){
        printf("VMLA, VMLAL, VMLS, VMLSL (integer)\n");
    }
    else if(A==9 && B1==1){
        printf("VMUL, VMULL (integer and polynomial)\n");
    }
    else if(A==0xA){
        printf("VPMAX, VPMIN (integer) \n");
    }
    else if(A==0xB && B1==0 && U==0){
        printf("VQDMULH\n");
    }
    else if(A==0xB && B1==0 && U==1){
        printf("VQRDMULH \n");
    }
    else if(A==0xB && B1==1 && U==0){
        printf("VPADD (integer) \n");
    }
    else if(A==0xC && B1==1 && U==0){
        printf("VFMA, VFMS\n");
    }
    else if(A==0xD && B1==0 && U==0 && C>>1==0){
        printf("VADD (floating-point) \n");
    }
    else if(A==0xD && B1==0 && U==0 && C>>1==1){
        printf("VSUB (floating-point) \n");
    }
    else if(A==0xD && B1==0 && U==1 && C>>1==0){
        printf("VPADD (floating-point) \n");
    }
    else if(A==0xD && B1==0 && U==1 && C>>1==1){
        printf("VABD (floating-point) \n");
    }
    else if(A==0xD && B1==1 && U==0 ){
        printf("VMLA, VMLS (floating-point)\n");
    }
    else if(A==0xD && B1==1 && U==1 && C>>1==0){
        printf("VMUL (floating-point) \n");
    }
    else if(A==0xE && B1==0 && U==0 && C>>1==0){
        printf("VCEQ (register) \n");
    }
    else if(A==0xE && B1==0 && U==1 && C>>1==0){
        printf("VCGE (register)\n");
    }
    else if(A==0xE && B1==0 && U==1 && C>>1==1){
        printf("VCGT (register)\n");
    }
    else if(A==0xE && B1==1 && U==1 ){
        printf("VACGE, VACGT, VACLE, VACLT\n");
    }
    else if(A==0xF && B1==0 && U==0 ){
        printf("VMAX, VMIN (floating-point)\n");
    }
    else if(A==0xF && B1==0 && U==1 ){
        printf("VPMAX, VPMIN (floating-point)\n");
    }
    else if(A==0xF && B1==1 && U==0 && C>>1==0){
        printf("VRECPS \n");
    }
    else if(A==0xF && B1==1 && U==0 && C>>1==1){
        printf("VRSQRTS\n");
    }
    else printf("error\n");
    i_code.affect==0;

}
void table_37(uint32_t insn){//One register and a modified immediate value Vreg
    uint8_t op = (insn>>5)&1;
    uint8_t cmode = (insn>>8)&0xF;
    uint8_t c0 = cmode&0x9;
    if(op==0){
        if(c0==0){
            printf("VMOV (immediate)\n");
        }
        else if(c0==1){
            printf("VORR (immediate) \n");
        }
        else if(cmode&0xD==8){
            printf("VMOV (immediate) \n");
        }
        else if(cmode&0xD==9){
            printf("VORR (immediate)\n");
        }
        else if(cmode>>2==3){
            printf("VMOV (immediate) \n");
        }
    }
    else if(op==1){
        if(c0==0){
            printf("VMVN (immediate) \n");
        }
        else if(c0==1){
            printf("VBIC (immediate) \n");
        }
        else if(cmode&0xD==8){
            printf("VMVN (immediate)\n");
        }
        else if(cmode&0xD==9){
            printf("VBIC (immediate) \n");
        }
        else if(cmode>>1==6){
            printf("VMVN (immediate)\n");
        }
        else if(cmode==0xE){
            printf("VMOV (immediate) \n");
        }
        else if(cmode==0xF){
            printf("undefined\n");
        }
    }
    else printf("error\n");
    i_code.affect==0;
}
void table_38(uint32_t insn){//Two registers and a shift amount  Vreg
    uint8_t A = (insn>>8)&0xF;
    uint8_t U = (insn>>24)&0x1;
    uint8_t L = (insn>>7)&1;
    uint8_t B1 = (insn>>6)&0x1;
    if(A==0){
        printf("VSHR\n");
    }
    else if(A==1){
        printf("VSRA\n");
    }
    else if(A==2){
        printf("VRSHR\n");
    }
    else if(A==3){
        printf("VRSRA\n");
    }
    else if(A==4 && U==1){
        printf("VSRI\n");
    }
    else if(A==5 && U==0){
        printf("VSHL (immediate) \n");
    }
    else if(A==5 && U==1){
        printf("VSLI\n");
    }
    else if(A>>1==3){
        printf("VQSHL, VQSHLU (immediate) \n");
    }
    else if(A==8 && U==0 && B1==0 && L==0){
        printf("VSHRN\n");
    }
    else if(A==8 && U==0 && B1==1 && L==0){
        printf("VRSHRN\n");
    }
    else if(A==8 && U==1 && B1==0 && L==0){
        printf("VQSHRN, VQSHRUN\n");
    }
    else if(A==8 && U==1 && B1==1 && L==0){
        printf("VQRSHRN, VQRSHRUN\n");
    }
    else if(A==9 && B1==0 && L==0){
        printf("VQSHRN, VQSHRUN\n");
    }
    else if(A==9 && B1==1 && L==0){
        printf("VQRSHRN, VQRSHRUN\n");
    }
    else if(A==0xA && B1==0 && L==0){
        printf("VSHLL\n");
    }
    else if(A==0xA && B1==0 && L==0){
        printf("VMOVL\n");
    }
    else if(A>>1==0x7 && L==0){
        printf("VCVT (between floating-point and fixed-point, Advanced SIMD) \n");
    }
    else printf("error\n");
    i_code.affect==0;
}
void table_39(uint32_t insn){//Three registers of different lengths Vreg
    uint8_t A = (insn>>8)&0xF;
    uint8_t U = (insn>>24)&0x1;
    if(A>>1==0){
        printf("VADDL, VADDW\n");
    }
    else if(A>>1==1){
        printf("VSUBL, VSUBW\n");
    }
    else if(A==4 && U==0){
        printf("VADDHN\n");
    }
    else if(A==4 && U==1){
        printf("VRADDHN\n");
    }
    else if(A==5){
        printf("VABA, VABAL\n");
    }
    else if(A==6 && U==0){
        printf("VSUBHN\n");
    }
    else if(A==6 && U==1){
        printf("VRSUBHN\n");
    }
    else if(A==7){
        printf("VABD, VABDL (integer)\n");
    }
    else if(A&0xD==8){
        printf("VMLA, VMLAL, VMLS, VMLSL (integer) \n");
    }
    else if(A&0xD==9 && U==0){
        printf("VQDMLAL, VQDMLSL\n");
    }
    else if(A==0xC){
        printf("VMUL, VMULL (integer and polynomial)\n");
    }
    else if(A==0xD && U==0){
        printf("VQDMULL\n");
    }
    else if(A==0xE){
        printf("VMUL, VMULL (integer and polynomial)\n");
    }
    else printf("error\n");
    i_code.affect==0;
}
void table_40(uint32_t insn){//Two registers and a scalar Vreg
    uint8_t A = (insn>>8)&0xF;
    uint8_t U = (insn>>24)&0x1;
    if(A&0xA==0){
        printf("VMLA, VMLAL, VMLS, VMLSL (by scalar)\n");
    }
    else if(A&0xB==2){
        printf("VMLA, VMLAL, VMLS, VMLSL (by scalar)\n");
    }
    else if(A&0xB==3 && U==0){
        printf("VQDMLAL, VQDMLSL\n");
    }
    else if(A>>1==4){
        printf("VMUL, VMULL (by scalar) \n");
    }
    else if(A==0xA){
        printf("VMUL, VMULL (by scalar) \n");
    }
    else if(A==0xB && U==0){
        printf("VQDMULL\n");
    }
    else if(A==0xC){
        printf("VQDMULH\n");
    }
    else if(A==0xD){
        printf("VQRDMULH\n");
    }
    else printf("error\n");
    i_code.affect==0;
}
void table_41(uint32_t insn){//Two registers, miscellaneous   Vreg
    uint8_t A = (insn>>16)&0x3;
    uint8_t B0 = (insn>>6)&0x1F; //B
    uint8_t B1 = B0>>1;
    uint8_t B3 = B0&0x11; //B2
    if(A==0){
        if(B1==0){
            printf("VREV16, VREV32, VREV64\n");
        }
        else if(B1==1){
            printf("VREV16, VREV32, VREV64\n");
        }
        else if(B1==2){
            printf("VREV16, VREV32, VREV64\n");
        }
        else if(B1>>1==2){
            printf("VPADDL\n");
        }
        else if(B1==8){
            printf("VCLS\n");
        }
        else if(B1==9){
            printf("VCLZ\n");
        }
        else if(B1==0xA){
            printf("VCNT\n");
        }
        else if(B1==0xB){
            printf("VMVN (register) \n");
        }
        else if(B1>>1==6){
            printf("VPADAL\n");
        }
        else if(B1==0xE){
            printf("VQABS\n");
        }
        else if(B1==0xF){
            printf("VQNEG\n");
        }
    }
    else if(A==1){
        if(B3==0){
            printf("VCGT (immediate #0)\n");
        }
        else if(B3==2){
            printf("VCGE (immediate #0) \n");
        }
        else if(B3==4){
            printf("VCEQ (immediate #0)\n");
        }
        else if(B3==6){
            printf("VCLE (immediate #0)\n");
        }
        else if(B3==8){
            printf("VCLT (immediate #0)\n");
        }
        else if(B3==0xC){
            printf("VABS\n");
        }
        else if(B3==0xE){
            printf("VNEG\n");
        }
    }
    else if(A==2){
        if(B1==0){
            printf("VSWP\n");
        }
        else if(B1==1){
            printf("VTRN\n");
        }
        else if(B1==2){
            printf("VUZP\n");
        }
        else if(B1==3){
            printf("VZIP\n");
        }
        else if(B0==8){
            printf("VMOVN\n");
        }
        else if(B0==9){
            printf("VQMOVN, VQMOVUN \n");
        }
        else if(B1==5){
            printf("VQMOVN, VQMOVUN\n");
        }
        else if(B0==0xC){
            printf("VSHLL\n");
        }
        else if(B0&0x1B==0x18){
            printf("VCVT (between half-precision and single-precision, Advanced SIMD)\n");
        }
    }
    else if(A==3){
        if(B0&0x1A==0x10){
            printf("VRECPE\n");
        }
        else if(B0&0x1A==0x12){
            printf("VRSQRTE\n");
        }
        else if(B0>>3==3){
            printf("VCVT (between floating-point and integer, Advanced SIMD)\n");
        }
    }
    else printf("error\n");
    i_code.affect==0;

}
void table_34(uint32_t insn){//Advanced SIMD data-processing instructions
    uint8_t U = (insn>>24)&1;
    uint8_t A = (insn>>19)&0x1F;
    uint8_t B0 = (insn>>8)&0xF;
    uint8_t C = (insn>>4)&0xF;
    if(A>>4==0)table_36(insn);//Three registers of the same length
    else if(A&0x17==0x10 && C&0x9==1)table_37(insn);//One register and a modified immediate value
    else if(A&0x17==0x11 && C&0x9==1)table_38(insn);//Two registers and a shift amount
    else if(A&0x16==0x12 && C&0x9==1)table_38(insn);//Two registers and a shift amount
    else if(A&0x14==0x14 && C&0x9==1)table_38(insn);//Two registers and a shift amount
    else if(A&0x10==0x10 && C&0x9==9)table_38(insn);//Two registers and a shift amount
    else if(A&0x14==0x10 && C&0x5==0)table_39(insn);//Three registers of different lengths
    else if(A&0x16==0x14 && C&0x5==0)table_39(insn);//Three registers of different lengths
    else if(A&0x14==0x10 && C&0x5==4)table_40(insn);//Two registers and a scalar
    else if(A&0x16==0x14 && C&0x5==4)table_40(insn);//Two registers and a scalar
    else if(U==0 && A&0x16==0x16 && C&1==0){
        printf("VEXT\n");
    }
    else if(U==1 && A&0x16==0x16 && B0>>3==0 && C&1==0)table_41(insn);//Two registers, miscellaneous
    else if(U==1 && A&0x16==0x16 && B0&0xC==8 && C&1==0){
        printf("VTBL VTBX\n");
    }
    else if(U==1 && A&0x16==0x16 && B0==0xC && C&0x9==0){
        printf("VDUP (scalar)\n");
    }
    else printf("error\n");
    i_code.affect==0;

}
void table_35(uint32_t insn){//Advanced SIMD element or structure load/store instructions
    uint8_t A = (insn>>23)&1;
    uint8_t B0 = (insn>>8)&0xF;
    uint8_t L = (insn>>21)&1;
    if(A==0 &&L==0){
        if(B0==2 || B0>>1==3 || B0==0xA){
            printf("VST1 (multiple single elements) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0==3 || B0>>1==4){
            printf("VST2 (multiple 2-element structures) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0>>1==2){
            printf("VST3 (multiple 3-element structures) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0>>1==0){
            printf("VST4 (multiple 4-element structures) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
    }
    else if(A==0 &&L==1){
        if(B0==2 || B0>>1==3 || B0==0xA){
            printf("VLD1 (multiple single elements) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0==3 || B0>>1==4){
            printf("VLD2 (multiple 2-element structures) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0>>1==2){
            printf("VLD3 (multiple 3-element structures) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0>>1==0){
            printf("VLD4 (multiple 4-element structures) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
    }
    else if(A==1 &&L==0){
        if(B0&0xB==0 || B0==8){
            printf("VST1 (single element from one lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0&0xB==1 || B0==9){
            printf("VST2 (single 2-element structure from one lane)\n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0&0xB==2 || B0==0xA){
            printf("VST3 (single 3-element structure from one lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0&0xB==3 || B0==0xB){
            printf("VST4 (single 4-element structure from one lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
    }
    else if(A==1 &&L==1){
        if(B0&0xB==0 || B0==8){
            printf("VLD1 (single element to one lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0==0xC){
            printf("VLD1 (single element to all lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0&0xB==1 || B0==9){
            printf("VLD2 (single 2-element structure to one lane)\n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0==0xD){
            printf("VLD2 (single 2-element structure to all lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0&0xB==2 || B0==0xA){
            printf("VLD3 (single 3-element structure to one lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0==0xE){
            printf("VLD3 (single 3-element structure to all lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0&0xB==3 || B0==0xB){
            printf("VLD4 (single 4-element structure to one lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
        else if(B0==0xF){
            printf("VLD4 (single 4-element structure to all lane) \n");
            i_code.vartype = 2;
            regimmVal(insn, i_code);
        }
    }
    printf("error\n");

}
void table_33(uint32_t insn){//Memory hints, Advanced SIMD instructions, and miscellaneous instructions
    uint8_t op1 = (insn>>20)&0x7F;
    uint8_t Rn = (insn>>16)&0xF;
    uint8_t op2 = (insn>>4)&0xF;
    if(op1==0x10 && op2&0x2==0 && Rn&1==0){
        printf("CPS (ARM)\n");
			cycle_cnt +=1;
        i_code.affect==0;
    }
    else if(op1==0x10 && op2==0 && Rn&1==1){
        printf("SETEND\n");
			cycle_cnt +=1;
        i_code.affect==0;
    }
    else if(op1>>5==1)table_34(insn);//Advanced SIMD data-processing instructions
    else if(op1&0x71==0x40)table_35(insn);//Advanced SIMD element or structure load/store instructions
    else if(op1&0x77==0x41){
        printf("unallocated (NOP)\n");
        i_code.affect==0;
    }
    else if(op1&0x77==0x45){
        printf("PLI imm literal\n");
			cycle_cnt +=1;
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op1&0x73==0x43){
        printf("unpredictable\n");
    }
    else if(op1&0x77==0x51 && Rn!=0xF){
        printf("PLD PLDW imm\n");
			cycle_cnt +=1;
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op1&0x77==0x51 && Rn==0xF){
        printf("unpredictable\n");
    }
    else if(op1&0x77==0x55 && Rn!=0xF){
        printf("PLD PLDW imm\n");
			cycle_cnt +=1;
        i_code.vartype = 21;
        regimmVal(insn, i_code);
    }
    else if(op1&0x77==0x55 && Rn==0xF){
        printf("PLD literal\n");
        i_code.affect==0;
			cycle_cnt +=1;
    }
    else if(op1==0x53){
        printf("unpredictable\n");
    }
    else if(op1==0x57){
        if(op2==0 || op2>>1==1 || op2==7 || op2>>3==1){
            printf("unpredictable\n");
        }
        else if(op2==1){
            printf("CLREX\n");
            i_code.affect==0;
			cycle_cnt +=1;
        }
        else if(op2==4){
            printf("DSB\n");
            i_code.affect==0;
			cycle_cnt +=1;
        }
        else if(op2==5){
            printf("DMB\n");
            i_code.affect==0;
			cycle_cnt +=1;
        }
        else if(op2==6){
            printf("ISB\n");
            i_code.affect==0;
			cycle_cnt +=1;
        }
    }
    else if(op1&0x7B==0x5B){
        printf("unpredictable\n");
    }
    else if(op1&0x77==0x61 && op2&1==0){
        printf("unallocated (NOP)\n");
			cycle_cnt +=1;
    }
    else if(op1&0x77==0x65 && op2&1==0){
        printf("PLI reg\n");
        i_code.vartype = 2;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1&0x77==0x71 && op2&1==0){
        printf("PLD PLDW reg\n");
        i_code.vartype = 2;
        regimmVal(insn, i_code);
    }
    else if(op1&0x77==0x75 && op2&1==0){
        printf("PLD PLDW reg\n");
        i_code.vartype = 2;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1&0x77==0x63 && op2&1==0){
        printf("unpredictable\n");
    }
    else if(op1==0x7F && op2==0xF){
        printf("permanently undefined\n");
    }
    else printf("error\n");

}
void table_06(uint32_t insn){//Unconditional instructions
    uint8_t op1 = (insn>>20)&0xFF;
    uint8_t Rn = (insn>>16)&0xF;
    uint8_t op = (insn>>4)&1;
    if(op1>>7==0)table_33(insn);//Memory hints, Advanced SIMD instructions, and miscellaneous instructions
    else if(op1&0xE5==0x84){
        printf("SRS (ARM)\n");
        i_code.affect==0;
			cycle_cnt +=1;
    }
    else if(op1&0xE5==0x81){
        printf("RFE\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1>>5==0x5){
        printf("BL, BLX (immediate) \n");
        i_code.affect==0;
			cycle_cnt +=1;
    }
    else if(op1&0xE1==0xC0 && op1&0xFB==0xC0){
        printf("STC, STC2\n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1&0xE1==0xC1 && op1&0xFB==0xC1 && Rn!=0xF){
        printf("LDC, LDC2 (immediate) \n");
        i_code.vartype = 21;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1&0xE1==0xC1 && op1&0xFB==0xC1 && Rn==0xF){
        printf("LDC, LDC2 (literal)\n");
        i_code.affect==0;
			cycle_cnt +=1;
    }
    else if(op1==0xC4){
        printf("MCRR, MCRR2\n");
        i_code.vartype = 25;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1==0xC5){
        printf("MRRC, MRRC2 \n");
        i_code.vartype = 25;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1>>4==0xE){
        printf("CDP, CDP2 \n");
        i_code.affect==0;
			cycle_cnt +=1;
    }
    else if(op1&0xF1==0xE0){
        printf("MCR, MCR2\n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else if(op1&0xF1==0xE1){
        printf("MRC, MRC2 \n");
        i_code.vartype = 19;
        regimmVal(insn, i_code);
			cycle_cnt +=1;
    }
    else printf("error\n");
}
void checkinsn(uint32_t insn){
	uint8_t cond = (insn>>28)&0xF;
	uint8_t op1 = (insn>>25)&0x7;
	uint8_t op = (insn>>4)&0x1;
	if(cond!=0xF){
		if(op1>>1 == 0)table_00(insn);//Data-processing and miscellaneous instructions
		else if(op1==0x2)table_01(insn);//Load/store word and unsigned byte
		else if(op1==0x3 && op==0)table_02(insn);//Load/store word and unsigned byte
		else if(op1==0x3 && op==1)table_03(insn);//Media instructions
		else if(op1>>1==0x2)table_04(insn);//Branch, branch with link, and block data transfer
		else if(op1>>1==0x3)table_05(insn);//Coprocessor instructions, and Supervisor Call
	}
	else if(cond==0xF)table_06(insn);//Unconditional instructions
}
int readinsn(){
	uint32_t insn;
	strcpy(buff,"");
	//fgets(buff,sizeof(buff),fptr);
#if 1
#ifdef QEMU_TEST
    //fprintf(result,"%s\n",buff);
    //while(strcmp(buff,"branch taken\n")==0||strcmp(buff,"branch not taken\n")==0){
    while(strncmp(buff,"branch taken",12)==0||strncmp(buff,"branch not taken",16)==0){
        if(strncmp(buff,"branch taken",12)==0){
            cycle_cnt += 2;
            fprintf(result,"branch taken\n");
            fprintf(result,"Cycle: %d\n",cycle_cnt);
	    fprintf(result,"===================\n");
        }
        if(strncmp(buff,"branch not taken",16)==0){
            fprintf(result,"branch not taken\n");
        }
        strcpy(buff,"");
        //fgets(buff,sizeof(buff),fptr);
    }
    sscanf(buff,"%x",&insn);
    fprintf(result,"op = %X ",insn);
    insn_op1 = insn;
#else
    sscanf(buff,"%x,%x\n",&tmp,&insn);
    fprintf(result,"opcode = %X ",insn);

    insn_op1 = insn;
    //fprintf(result,"op1 = %X ",insn_op1);
#endif
#endif // 1
    return 1;
}
int read_table(uint32_t insn){
	//uint32_t insn = 0xe8bd8810;
	//i_code.affect=1;
	//fptr = fopen("Trace.csv","r");
	int temp=0;
#ifdef QEMU_TEST
	//fptr = fopen(filename,"r");
	//result = fopen("test2","w");
#else
	//result = fopen("result2","w");
#endif
	/*if(!fptr){
		printf("failed to open file\n");
		exit(1);
	}*/
	//fprintf(result,"=========================\n");
	//while(!feof(fptr)){
		//readinsn();
		//insn = insn_op1;
		checkinsn(insn);
		/*if(i_code.affect == 1 && checkLast(i_code_t)){
        	printf("type = %d\n",i_code.vartype);
        	//fprintf(result,"type = %d\n",i_code.vartype);
        	regs(i_code, i_code_t);
		}
		i_code_t = i_code;*/

            	//fprintf(result,"Cycle: %d\n",cycle_cnt-cycle_last);
	        temp = cycle_cnt - cycle_last;
		cycle_last = cycle_cnt;
		//fprintf(result,"=========================\n");
		
	//}
	return temp;
}
